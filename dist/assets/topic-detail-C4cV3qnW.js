import{h as C,O as D,al as w,r as _,i as T,o as c,f as y,w as t,d as s,am as I,u as m,c as L,L as V,a2 as S,b as g,t as x}from"./index-AryBdys7.js";import{a as h}from"./VGrid-H4nAnDsn.js";import{b as n,V as A,a as v}from"./VCardText-Ccz8IcNf.js";import{V as z}from"./VCard-DRv5nRi-.js";import{V as M}from"./VForm-2GwK3Akv.js";import{V as P}from"./VSelect-kxivoCMj.js";import{V as U}from"./VTextField-ZuzApsZG.js";import{V as j}from"./VSwitch-BK7-Uxyt.js";import{V as B}from"./VAlert-Dclja9nK.js";import"./VCardTitle-gQEIOlk7.js";import"./VAvatar-Bk7bSWw5.js";import"./VImg-BnnpGyml.js";import"./index-DYhDWbac.js";import"./VInput-0JT9cSES.js";import"./forwardRefs-BgKS6qNZ.js";import"./VMenu-CwDODdxf.js";import"./ssrBoot-P8F_o1ED.js";import"./VOverlay-souyEm7B.js";import"./easing-DY7PVvcf.js";import"./lazy-IcXCMn0l.js";import"./VCheckboxBtn-CNvXUyKk.js";import"./VSelectionControl-COivTBzk.js";import"./VChip-0NNzlpK8.js";const F={key:0,class:"text-red-500 text-sm"},N={__name:"TopicDetailUpsert",setup($){const p=C();D();const u=localStorage.getItem("id"),a=w({system_id:0,topic:"",is_active:0}),r=w({}),d=localStorage.getItem("token"),f=_(""),l=_(""),b=_([]),R=async o=>{try{const e=await h.get(`https://gateway.berkompeten.com/api/admin/master/topic/detail?id=${o}`,{headers:{Authorization:`Bearer ${d}`}});Object.assign(a,e.data.data)}catch(e){console.error("Error fetching topic data:",e)}},E=async()=>{try{const o=await h.get("https://gateway.berkompeten.com/api/admin/master/system/fetch",{headers:{Authorization:`Bearer ${d}`}});b.value=o.data.data.map(e=>({id:e.id,name:e.topic}))}catch(o){console.error("Error fetching system options:",o)}},O=async()=>{try{await h({method:"post",url:"https://gateway.berkompeten.com/api/admin/master/topic/upsert",data:a,headers:{Authorization:`Bearer ${d}`}}),f.value="Topic saved successfully!",setTimeout(()=>{k(),p.push("/topic-management")},2e3)}catch(o){console.error("Error submitting form:",o),o.response&&o.response.data?o.response.status===500?l.value=o.response.data.message||"An error occurred while saving. Please try again.":o.response.data.error?(Object.assign(r,o.response.data.message),console.log("ERROR: ",r)):l.value="An error occurred while saving. Please try again.":l.value="An error occurred while saving. Please try again."}},k=()=>{Object.assign(a,{system_id:0,topic:"",is_active:0})};return T(()=>{E(),u?R(u):localStorage.removeItem("id")}),(o,e)=>(c(),y(v,null,{default:t(()=>[s(n,{cols:"12"},{default:t(()=>[s(z,{title:"Topic Details"},{default:t(()=>[s(A,null,{default:t(()=>[s(M,{onSubmit:I(O,["prevent"])},{default:t(()=>[s(v,null,{default:t(()=>[s(n,{cols:"12"},{default:t(()=>[s(P,{modelValue:a.system_id,"onUpdate:modelValue":e[0]||(e[0]=i=>a.system_id=i),"error-messages":r.system_id,label:"System List",items:m(b),placeholder:"Select System List","item-value":"id","item-title":"name"},null,8,["modelValue","error-messages","items"])]),_:1}),s(n,{cols:"12"},{default:t(()=>[s(U,{modelValue:a.topic,"onUpdate:modelValue":e[1]||(e[1]=i=>a.topic=i),"error-messages":r.topic,label:"Topic"},null,8,["modelValue","error-messages"])]),_:1}),s(n,{cols:"12"},{default:t(()=>[s(j,{color:"#0080ff",modelValue:a.is_active,"onUpdate:modelValue":e[2]||(e[2]=i=>a.is_active=i),"error-messages":r.is_active,label:"Is Active"},null,8,["modelValue","error-messages"]),r.image_url?(c(),L("div",F)):V("",!0)]),_:1}),s(n,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:t(()=>[s(S,{type:"submit",color:"#0080ff"},{default:t(()=>[g("Save")]),_:1}),s(S,{onClick:k,color:"secondary",variant:"outlined"},{default:t(()=>[g("Reset")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(A,null,{default:t(()=>[m(f)?(c(),y(B,{key:0,type:"success",dismissible:"","onClick:close":e[3]||(e[3]=i=>f.value="")},{default:t(()=>[g(x(m(f)),1)]),_:1})):V("",!0),m(l)?(c(),y(B,{key:1,type:"error",dismissible:"","onClick:close":e[4]||(e[4]=i=>l.value="")},{default:t(()=>[g(x(m(l)),1)]),_:1})):V("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}},de={__name:"topic-detail",setup($){const p=localStorage.getItem("token"),u=_(null),a=C();return T(async()=>{if(p)try{const r=await h.get("https://gateway.berkompeten.com/api/admin/profile",{headers:{Authorization:`Bearer ${p}`}});u.value=r.data}catch(r){r.response&&r.response.status===401&&a.push("/login")}else a.push("/login")}),(r,d)=>(c(),y(v,{class:"match-height"},{default:t(()=>[s(n,{cols:"12",md:"12"},{default:t(()=>[s(N)]),_:1})]),_:1}))}};export{de as default};
