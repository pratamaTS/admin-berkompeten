import{u as C,g as d,P as D,h as v,o as p,c as h,a as e,G as V,aT as T,d as m,w,F as N,aU as O,t as s,f as P}from"./index-B5nBLcgW.js";import{a as _}from"./VGrid-CSSzMaaB.js";import{V as S}from"./VTable-vNZueaox.js";import{V as U}from"./VRow-Kjp9ojPd.js";import{V as z}from"./VCol-05f2kP35.js";const E={class:"table-header"},I=e("thead",null,[e("tr",null,[e("th",null,"Packet Name"),e("th",null,"Subtopic Name"),e("th",null,"Question Number"),e("th",null,"Question"),e("th",null,"Option A"),e("th",null,"Option B"),e("th",null,"Option C"),e("th",null,"Option D"),e("th",null,"Option E"),e("th",null,"Correct Answer"),e("th",null,"Discussion"),e("th",null,"Is Active"),e("th",null,"Created At"),e("th",null,"Actions")])],-1),M=["innerHTML"],Q=["onClick"],R=e("span",{class:"material-icons"},"edit",-1),F=[R],H=["onClick"],j=e("span",{class:"material-icons"},"delete",-1),G=[j],J=["disabled"],K=["disabled"],W={__name:"QuestionList",setup(g){const r=C(),i=localStorage.getItem("token"),u=d([]),o=d(""),l=d({current_page:1,from:1,last_page:1,next_page_url:null,prev_page_url:null,total:0}),c=async(t=1)=>{try{const n=await _.get(`https://gateway.berkompeten.com/api/admin/master/question?page=${t}`,{headers:{Authorization:`Bearer ${i}`}});u.value=n.data.data,l.value=n.data}catch(n){console.log("err: ",n),n.response&&n.response.status===401&&(localStorage.removeItem("token"),r.push("/login"))}},L=D(()=>o.value?u.value.filter(t=>t.name.toLowerCase().includes(o.value.toLowerCase())||t.question_packet.name.toLowerCase().includes(o.value.toLowerCase())||t.subtopic_list.subtopic.toLowerCase().includes(o.value.toLowerCase())||t.question_number.toLowerCase().includes(o.value.toLowerCase())||t.scenario.toLowerCase().includes(o.value.toLowerCase())||t.question.toLowerCase().includes(o.value.toLowerCase())||t.option_a.toLowerCase().includes(o.value.toLowerCase())||t.option_b.toLowerCase().includes(o.value.toLowerCase())||t.option_c.toLowerCase().includes(o.value.toLowerCase())||t.option_d.toLowerCase().includes(o.value.toLowerCase())||t.option_e.toLowerCase().includes(o.value.toLowerCase())||t.correct_answer.toLowerCase().includes(o.value.toLowerCase())||t.image_url.toLowerCase().includes(o.value.toLowerCase())||t.discussion.toLowerCase().includes(o.value.toLowerCase())||t.created_at.toLowerCase().includes(o.value.toLowerCase())||t.updated_at.toLowerCase().includes(o.value.toLowerCase())):u.value),b=()=>{l.value.next_page_url&&c(l.value.current_page+1)},k=()=>{l.value.prev_page_url&&c(l.value.current_page-1)},f=()=>{r.push(`/question/detail?id=${id}`)},y=async()=>{try{const t=await _.get("https://gateway.berkompeten.com/api/admin/master/question/download-template",{responseType:"blob",headers:{Authorization:`Bearer ${i}`}}),n=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download","questions_template.xlsx"),document.body.appendChild(a),a.click()}catch(t){console.error("Error downloading template:",t)}},x=()=>{r.push("/bulk-upsert")},B=t=>{r.push(`/question/detail?id=${t}`)},$=async t=>{try{await _.delete(`https://gateway.berkompeten.com/api/admin/master/question?question_id=${t}`,{headers:{Authorization:`Bearer ${i}`}}),c(l.value.current_page)}catch(n){console.log("err: ",n)}};return v(()=>{c()}),(t,n)=>(p(),h("div",null,[e("div",E,[V(e("input",{"onUpdate:modelValue":n[0]||(n[0]=a=>o.value=a),placeholder:"Search..."},null,512),[[T,o.value]]),e("button",{onClick:f},"Create"),e("button",{onClick:x},"Bulk Upsert"),e("button",{onClick:y},"Download Template")]),m(S,{height:"250","fixed-header":""},{default:w(()=>[I,e("tbody",null,[(p(!0),h(N,null,O(L.value,a=>(p(),h("tr",{key:a.id},[e("td",null,s(a.question_packet.name),1),e("td",null,s(a.subtopic_list.subtopic),1),e("td",null,s(a.question_number),1),e("td",null,s(a.question),1),e("td",null,s(a.option_a),1),e("td",null,s(a.option_b),1),e("td",null,s(a.option_c),1),e("td",null,s(a.option_d),1),e("td",null,s(a.option_e),1),e("td",null,s(a.correct_answer),1),e("td",{innerHTML:a.discussion},null,8,M),e("td",null,s(a.is_active),1),e("td",null,s(a.created_at),1),e("td",null,[e("button",{onClick:A=>B(a.id)},F,8,Q),e("button",{onClick:A=>$(a.id)},G,8,H)])]))),128))])]),_:1}),e("div",null,[e("button",{onClick:k,disabled:!l.value.prev_page_url},"Previous",8,J),e("button",{onClick:b,disabled:!l.value.next_page_url},"Next",8,K)])]))}},te={__name:"question-management",setup(g){const r=localStorage.getItem("token"),i=d(null),u=C();return v(async()=>{if(r)try{const o=await _.get("https://gateway.berkompeten.com/api/admin/profile",{headers:{Authorization:`Bearer ${r}`}});i.value=o.data}catch(o){o.response&&o.response.status===401&&u.push("/login")}else u.push("/login")}),(o,l)=>(p(),P(U,{class:"match-height"},{default:w(()=>[m(z,{cols:"12",md:"12"},{default:w(()=>[m(W)]),_:1})]),_:1}))}};export{te as default};
